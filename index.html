<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/MTY_C_b_round2_512.png" />

    <!-- 반응형 뷰포트 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- 라이트 모드 고정 -->
    <meta name="color-scheme" content="light" />
    <meta name="theme-color" content="#ffffff" />
    <style>
      :root { color-scheme: light; }
      html, body { background:#ffffff; color:#111; }
      img, svg, picture, video, canvas { filter: none !important; }
    </style>

    <title>C&KInsight</title>

    <!-- 구글 폰트 -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />

    <!-- ✅ KakaoTalk in-app → 외부 브라우저 열기 (도메인 자동 인식 + fallback 버튼) -->
    <script>
      (function () {
        var ua = navigator.userAgent || '';
        var isKakao   = /KAKAOTALK/i.test(ua);
        var isAndroid = /Android/i.test(ua);
        var isIOS     = /iPhone|iPad|iPod/i.test(ua);

        if (!isKakao) return; // 일반 브라우저는 아무 것도 하지 않음

        // 현재 페이지 주소 자동 사용 (Vercel 프리뷰 / 실제 도메인 모두 대응)
        var ORIGIN = location.origin;
        var HOST   = location.host;
        var PATH   = location.pathname + location.search;
        var SCHEME = location.protocol.replace(':','');

        function openExternal() {
          if (isAndroid) {
            // Chrome으로 열기 (fallback 포함)
            var intent = 'intent://' + HOST + PATH +
              '#Intent;scheme=' + SCHEME +
              ';package=com.android.chrome' +
              ';S.browser_fallback_url=' + encodeURIComponent(ORIGIN + PATH) +
              ';end';
            location.href = intent;
          } else if (isIOS) {
            // iOS Safari로 열기
            location.href = ORIGIN + PATH;
          }
        }

        function attachBar() {
          if (document.getElementById('open-external-bar')) return;

          var bar = document.createElement('div');
          bar.id = 'open-external-bar';
          bar.style.cssText =
            'position:fixed;left:12px;right:12px;bottom:16px;z-index:2147483647;' +
            'background:#111;color:#fff;padding:12px 14px;border-radius:12px;' +
            'box-shadow:0 6px 20px rgba(0,0,0,.2);display:flex;align-items:center;justify-content:space-between;' +
            'gap:12px;font-size:14px;line-height:1.3;';
          bar.innerHTML =
            '<span>카카오 인앱에서는 레이아웃이 깨질 수 있어요.</span>' +
            '<a id="open-external-btn" href="#" style="background:#D08700;color:#fff;padding:8px 12px;border-radius:9999px;text-decoration:none;white-space:nowrap;">외부 브라우저로 열기</a>';
          document.body.appendChild(bar);

          document.getElementById('open-external-btn').addEventListener('click', function (e) {
            e.preventDefault();
            openExternal();
          }, { passive:false });
        }

        function showFallbackBar() {
          if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', attachBar, { once: true });
          } else {
            attachBar();
          }
        }

        // 1) 자동 시도
        openExternal();

        // 2) 실패 시 fallback 배너 노출
        setTimeout(function () {
          if (document.visibilityState === 'visible') showFallbackBar();
        }, 700);

        // 3) 페이지 재활성화 시에도 배너 보장
        window.addEventListener('pageshow', function () {
          if (document.visibilityState === 'visible' && !document.getElementById('open-external-bar')) {
            showFallbackBar();
          }
        });
      })();
    </script>
  </head>

  <body class="bg-white text-gray-900">
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
